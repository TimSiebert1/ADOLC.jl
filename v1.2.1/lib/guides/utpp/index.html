<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Univariate Taylor Polynomial Propagation · ADOLC.jl</title><meta name="title" content="Univariate Taylor Polynomial Propagation · ADOLC.jl"/><meta property="og:title" content="Univariate Taylor Polynomial Propagation · ADOLC.jl"/><meta property="twitter:title" content="Univariate Taylor Polynomial Propagation · ADOLC.jl"/><meta name="description" content="Documentation for ADOLC.jl."/><meta property="og:description" content="Documentation for ADOLC.jl."/><meta property="twitter:description" content="Documentation for ADOLC.jl."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">ADOLC.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><span class="tocitem">Guides</span><ul><li><a class="tocitem" href="../seed_matrix/">Seed Matrix</a></li><li class="is-active"><a class="tocitem" href>Univariate Taylor Polynomial Propagation</a></li><li><a class="tocitem" href="../tape_management/">Tape Management</a></li><li><a class="tocitem" href="../ww_cxx_mem/">Working with C++ Memory</a></li><li><a class="tocitem" href="../performance_tips/">Performance Tips</a></li></ul></li><li><a class="tocitem" href="../../derivative_modes/">Derivative Modes</a></li><li><a class="tocitem" href="../../reference/">Reference</a></li><li><a class="tocitem" href="../../wrapped_fcts/">Wrapped Functions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Guides</a></li><li class="is-active"><a href>Univariate Taylor Polynomial Propagation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Univariate Taylor Polynomial Propagation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="github.com/TimSiebert1/ADOLC.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Univariate-Taylor-Polynomial-Propagation"><a class="docs-heading-anchor" href="#Univariate-Taylor-Polynomial-Propagation">Univariate Taylor Polynomial Propagation</a><a id="Univariate-Taylor-Polynomial-Propagation-1"></a><a class="docs-heading-anchor-permalink" href="#Univariate-Taylor-Polynomial-Propagation" title="Permalink"></a></h1><p>The univariate Taylor polynomial propagation (UTPP) aims to compute the univariate Taylor polynomial (UTP) <span>$\varphi_f$</span> of a function <span>$f$</span> and is given as a polynomial in <span>$t \in \mathbb{R}$</span>:</p><p class="math-container">\[\varphi_f(t) := \sum_{i=0}^d f^i(x)t^i,\]</p><p>where <span>$d \in \mathbb{N}$</span> is the maximal order or degree and <span>$x \in \mathbb{R}^n$</span> the evaluation point of the UTP. <span>$f^i(x)$</span> defines the <span>$i$</span>-th uniariate Taylor coefficient (UTC):</p><p class="math-container">\[f^i(x) := \sum_{\underset{|k|=i}{k \in \mathbb{N}^n}} \frac{1}{k!}\frac{\partial^k f(x)}{\partial^k x}.\]</p><p>Since the UTP is computed component-wise (w.r.t the output of <span>$f$</span>), it is usually assumed <span>$f$</span> has a one dimensional output. </p><p>To compute the polynomial, UTPP leverages so-called recurrence relations. Recurrence relations are formulas specifying the UTC. For example: <br/>Let <span>$n=2$</span>, <span>$f(x) = x_1 + x_2$</span> and <span>$h$</span> and <span>$g$</span> suitable functions. The recurrence relation for the <span>$i$</span>-th UTC of <span>$f$</span> up to degree <span>$d=2$</span> is given by</p><p class="math-container">\[f^i(x) = h^i(x) + g^i(x).\]</p><p>Therefore, if we know the UTPs of <span>$h$</span> and <span>$g$</span> we can conclude the UTP of <span>$f$</span>. These kind of formulas motivate the term &quot;propagation&quot; of input polynomials. Various recurrence relations can be found in table 13.1 and 13.2 of [<a href="../../../#griewank_13_2008">2</a>]. AD packages implement the recurrence relations for a set of elemental functions. If a user-defined function is decomposable into these elemental functions, the AD package can computes the UTP automatically.  </p><p>ADOLC.jl leverages <a href="https://github.com/coin-or/ADOL-C">ADOL-C</a>&#39;s utilities for UTPP and wraps it in the <a href="../../reference/#ADOLC.univariate_tpp"><code>univariate_tpp</code></a> driver, which allows the easy computation of Taylor polynomials of functions with arbitrary input and output dimension. To demonstrate the application of <a href="../../reference/#ADOLC.univariate_tpp"><code>univariate_tpp</code></a>, lets go back to the example. If we set <span>$n = 2$</span> and <span>$h(x) = \sin(x_1)$</span>, <span>$g(x) = x_2$</span> for all <span>$x=(x_1, x_2) \in \mathbb{R}^2$</span>, we have by definition of the UTC</p><p class="math-container">\[f^0(x) = h^0(x) + g^0(x) = \sin(x_1) + x_2 \\
f^1(x) = h^1(x) + g^1(x) = \cos(x_1)x_1&#39; + x_2&#39; \\
f^2(x) = \frac{1}{2}\left(-\sin(x_1)(x_1&#39;)^2 + \cos(x_1)x_1&#39;&#39;\right) + \frac{1}{2}x_2&#39;&#39;.\]</p><p>The formulas above emphasize that the values of <span>$x_i&#39;$</span> and <span>$x_i&#39;&#39;$</span> must be given. Intuitively one could set them to the derivatives of the projections by interpreting <span>$x_i = p_i(x)$</span>. Then <span>$x_i&#39; = 1$</span> and all further derivatives are zero. However, the input values <span>$x_i$</span> could be generated from a complex computation. A user may wants to include the derivative information of this computation in <span>$x_i&#39;, x_i&#39;&#39;, \dots$</span>. To this end, <a href="https://github.com/coin-or/ADOL-C">ADOL-C</a> allows a user to provide distinct input UTC for each input variable <span>$x_i$</span>, where the evaluation point is one dimensional. Those UTC have the form:</p><p class="math-container">\[\sum_{j=0}^d y^j t^j.\]</p><p>The coefficients <span>$y^j$</span> are user-given, which means we need <span>$d+1$</span> coefficients for every input variable <span>$x_i$</span>. If the UTC above corresponds to the input variable <span>$x_1$</span>, internally the following connection between the coefficient <span>$y^i$</span> and the <span>$i$</span>-th derivative of <span>$x_1$</span> is expected</p><p class="math-container">\[y^i = \frac{1}{i!}x_1^{(i)}.\]</p><p>Here it is assumed that <span>$x_1$</span> is provided by some function, which makes sense of the derivative. The output of <a href="../../reference/#ADOLC.univariate_tpp"><code>univariate_tpp</code></a> are the UTC of <span>$f$</span>&#39;s UTP. <br/>In our example, lets first set the input UTCs corresponding to the UTP of the projections <span>$p_i(x) = x_i$</span>. For <span>$x_1$</span> we get <span>$y^0 = x_1$</span>, <span>$y^1 = 1$</span> and <span>$y^2 = 0$</span>. Similarly for <span>$x_2$</span>. If we further choose <span>$x = (\frac{\pi}{2}, \frac{1}{2})$</span> we can compute the UTCs <span>$f^0$</span>, <span>$f^1$</span> and <span>$f^2$</span> of <span>$f$</span> with ADOLC.jl easily:</p><pre><code class="language-julia hljs">f(x) = sin(x[1]) + x[2]
x = [pi / 2, 0.5]
d = 2
utp = univariate_tpp(f, x, 2)

# output

1×3 CxxMatrix:
 1.5  1.0  -0.5</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The initialization with the input UTP based on the projections is done automatically if no other initialization UTP is provided to the parameter <code>init_tp</code>.</p></div></div><p>Next, we comput the UTP at the same evaluation point <span>$x = (\frac{\pi}{2}, \frac{1}{2})$</span>, but now <span>$x_2$</span> is obtained from the function <span>$x_2(s) = s^2 + 3s + \frac{1}{2}$</span>, while <span>$x_1$</span> is still determined by the projection <span>$p_1$</span>. Then, <span>$x_2(0) = \frac{1}{2}$</span>, <span>$x_2&#39;(0) = 3$</span> and <span>$x_2&#39;&#39;(0) = 2$</span>. The corresponding UTCs are given as <span>$y^0 = \frac{1}{2}$</span>, <span>$y^1 = 3$</span> and <span>$y^2 = 1$</span>. The input UTCs are now written to the parameter <code>init_tp</code> of <a href="../../reference/#ADOLC.univariate_tpp"><code>univariate_tpp</code></a>. The UTCs of <span>$f$</span> are again easily computed:</p><pre><code class="language-julia hljs">f(x) = sin(x[1]) + x[2]
x = [pi / 2, 0.5]
d = 2
init_tp = CxxMatrix([[pi /2, 0.5] [1.0, 3.0] [0.0, 1.0]])
utp = univariate_tpp(f, x, d, init_tp)

# output

1×3 CxxMatrix:
 1.5  3.0  0.5</code></pre><p>For more information on univariate Taylor polynomial propagation I recommend to read the Chapter 13.2 &quot;Taylor Polynomial Propagation&quot; from [<a href="../../../#griewank_13_2008">2</a>].</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../seed_matrix/">« Seed Matrix</a><a class="docs-footer-nextpage" href="../tape_management/">Tape Management »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Monday 5 August 2024 18:12">Monday 5 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
