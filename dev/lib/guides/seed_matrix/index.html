<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Seed Matrix · ADOLC.jl</title><meta name="title" content="Seed Matrix · ADOLC.jl"/><meta property="og:title" content="Seed Matrix · ADOLC.jl"/><meta property="twitter:title" content="Seed Matrix · ADOLC.jl"/><meta name="description" content="Documentation for ADOLC.jl."/><meta property="og:description" content="Documentation for ADOLC.jl."/><meta property="twitter:description" content="Documentation for ADOLC.jl."/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">ADOLC.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><span class="tocitem">Guides</span><ul><li class="is-active"><a class="tocitem" href>Seed Matrix</a></li><li><a class="tocitem" href="../utpp/">Univariate Taylor Polynomial Propagation</a></li><li><a class="tocitem" href="../tape_management/">Tape Management</a></li><li><a class="tocitem" href="../ww_cxx_mem/">Working with C++ Memory</a></li><li><a class="tocitem" href="../performance_tips/">Performance Tips</a></li></ul></li><li><a class="tocitem" href="../../derivative_modes/">Derivative Modes</a></li><li><a class="tocitem" href="../../reference/">Reference</a></li><li><a class="tocitem" href="../../wrapped_fcts/">Wrapped Functions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Guides</a></li><li class="is-active"><a href>Seed Matrix</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Seed Matrix</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="github.com/TimSiebert1/ADOLC.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Seed-Matrix"><a class="docs-heading-anchor" href="#Seed-Matrix">Seed-Matrix</a><a id="Seed-Matrix-1"></a><a class="docs-heading-anchor-permalink" href="#Seed-Matrix" title="Permalink"></a></h1><p>This guide is related to the <a href="../../derivative_modes/#Higher-Order">higher-order</a> derivative computation with  <a href="../../reference/#ADOLC.derivative"><code>derivative</code></a> or <a href="../../reference/#ADOLC.derivative!"><code>derivative!</code></a>. Internally, the drivers are based on the propagation of univariate Taylor polynomials [<a href="../../../#griewank_evaluating_1999">1</a>]. The underlying method leverages a <code>seed</code> matrix <span>$S\in \mathbb{R}^{n \times p}$</span> to compute mixed-partials of arbitrary order for a function <span>$f:\mathbb{R}^n \to \mathbb{R}^m$</span> in the form: </p><p class="math-container">\[    \frac{\partial^k f(x + Sz)}{\partial^k z}\big|_{z=0} \]</p><p>for some <span>$z \in \mathbb{R}^p$</span>. Usually, <span>$S$</span> is the <em>identity</em> or the <em>partial identity</em> (see <a href="../../reference/#ADOLC.create_partial_cxx_identity"><code>create_partial_cxx_identity</code></a>), which is also the case, when no <code>seed</code> is passed to the driver. To switch between both identity options the flag <code>id_seed</code> can be used. In the case of identity, the formula above boils down to </p><p class="math-container">\[    \frac{\partial^k f(x + Sz)}{\partial^k z}\big|_{z=0}= \frac{\partial^k f(x)}{\partial^k x}.\]</p><p>Moreover, the partial identity results in the same but is more efficient. Leveraging the partial identity ensures that only the derivatives of the requested derivative directions are computed, and this is explained briefly in the following paragraph.   </p><p>Assume we want to compute the derivatives specified in the <a href="../../derivative_modes/#Partial-Format">Partial-Format</a>: [[4, 0, 0, 3], [2, 0, 0, 4], [1, 0, 0, 1]].   Obviously, none of the derivatives includes <span>$x_2$</span> and <span>$x_3$</span>. To avoid unnecessary computations (i.e., the propagation of unnecessary univariate Polynomials), the partial identity is created, stacking only those canonical basis vectors that are related to the requested derivative directions. In our case, the partial identity looks like this:  </p><p class="math-container">\[\left[
    \begin{matrix}
    1 &amp; 0 \\
    0 &amp; 0 \\
    0 &amp; 0 \\
    0 &amp; 1 
    \end{matrix}
 \right].\]</p><p>As you can see, the directions are reduced from four to two. In general, the number of required univariate Polynomial propagations to compute all mixed-partials up to degree <span>$d$</span> of for <span>$f$</span> is <span>$\left( \begin{matrix} n - 1 + d \\ d \end{matrix} \right)$</span>. Leveraging the <code>seed</code> <span>$S$</span> reduces this number to <span>$\left( \begin{matrix} p - 1 + d \\ d \end{matrix} \right)$</span>, where <span>$p$</span> is often much smaller than <span>$n$</span>. In addition, <span>$S$</span> can be used as a subspace projection. For example, if <span>$S=[1, \dots, 1]^T$</span>, you could compute the sum of the different univariate Taylor coefficients:</p><pre><code class="language-julia hljs">using ADOLC
f(x) = x[1]^3*x[2]^2 - x[2]^3
x = [1.0, 1.0]
partials = [[1], [2], [3]]
seed = CxxMatrix([[1.0, 1.0];;])
res = derivative(f, x, partials, seed)

# output

1×3 CxxMatrix:
 2.0  14.0  54.0</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../../">« Home</a><a class="docs-footer-nextpage" href="../utpp/">Univariate Taylor Polynomial Propagation »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.5.0 on <span class="colophon-date" title="Thursday 15 August 2024 16:00">Thursday 15 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
